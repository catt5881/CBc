<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CB Charts</title>
    <link rel="icon" type="image/png" href="https://raw.githubusercontent.com/catt5881/CBc/main/logo.JPG">


    <!-- 引入jQuery -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>

    <!-- 引入DataTables CSS -->
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.21/css/jquery.dataTables.css">

    <!-- 引入DataTables JavaScript -->
    <script type="text/javascript" src="https://cdn.datatables.net/1.10.21/js/jquery.dataTables.js"></script>
    <!-- 引入Papa Parse库 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">
    <!--<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script> -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-Fy6S3B9q64WdZWQUiU+q4/2Lc9npb8tCaSX9FK7E8HnRr0Jz8D6OP9dO5Vg3Q9ct" crossorigin="anonymous"></script>
    <style>
        #imgHead{
            width: 30%;
            height: 30%;
            max-width: 100%;
            max-height: 100%;
            margin-left: auto;
            margin-right: auto;
            margin-top: -8px;
        }
        #imgCat{
            width: 5%;
            height: 5%;
            max-width: 30%;
            max-height: 30%; 
            border-radius: 50%;
            margin-left: auto;
            margin-right: auto;
            margin-top: -20px;
            

        }
        
        #table-container {
            width: 100%;
            margin: auto;
        }

        #myTable {
            font-size: 0.9em;
            width: 100%;
        }

        #myTable th, #myTable td {
            padding: 8px;
        }

        #myTable thead th {
            background-color: #f2f2f2;
            color: #333;
        }

        #myTable tbody tr {
            background-color: #fff;
        }

        #table2-container {
            width: 100%;
            margin: auto;
        }

        #myTable2 {
            font-size: 0.9em;
            width: 100%;
        }

        #myTable2 th, #myTable td {
            padding: 8px;
        }

        #myTable2 thead th {
            background-color: #f2f2f2;
            color: #333;
        }

        #myTable2 tbody tr {
            background-color: #fff;
        }
        .stock_id-column-column {
            width: 0.5%; /* 设置category列的宽度 */
        }
        .name-column {
            width: 5%; /* 设置category列的宽度 */
        }
        .sum-column {
            width: 5%; /* 设置category列的宽度 */
        }        
        .外資投信-column {
            width: 5%; /* 设置category列的宽度 */
        }
        .category-column {
            width: 21%; /* 设置category列的宽度 */
        }



    </style>

</head>
<body>
    
    <nav class="navbar navbar-expand-lg navbar-light" style="background-color: rgba(216, 216, 216, 0.973);">
        <a class="navbar-brand" href="#">CBindex</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
      
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav mr-auto">
            <li class="nav-item active">
              <a class="nav-link" href="index.html">Home <span class="sr-only">(current)</span></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="cbc.html">CB</a>
            </li>
            
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="cb_list.html" role="button" data-toggle="dropdown" aria-expanded="false"> 選股 </a>
              <div class="dropdown-menu">
                <a class="dropdown-item" href="cb_list.html">CB List</a>
                <a class="dropdown-item" href="cb_financial report.html">CB 財報評分</a>
                <a class="dropdown-item" href="stock_financial report.html">上市櫃財報評分</a>

                <!--
                <div class="dropdown-divider"></div>
                <a class="dropdown-item" href="#">Something else here</a> 
              </div>-->
            </li>
            <!--
            <li class="nav-item">
              <a class="nav-link disabled">Disabled</a>
            </li>
            -->
          </ul>
          <form class="form-inline my-2 my-lg-0">
            <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
            <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
          </form>
        </div>
    </nav>

    <!--<img class="d-block w-100" src="pig_head.jpg" id="imgHead" alt=""> -->
    <img class="d-block" src="catt.jpg" id="imgCat" alt="">

 
    




<div2 id="table2-container" class="container mt-5">
    <h2>上市櫃現股財報評分1~10級(分數越高，代表數值在歷史資料中，數值越大)</h2>
    <table id="myTable2" class="display">
        <thead>
            <tr>
                <th>stock_id</th>
                <th>name</th>
                <th>近一日收盤價(S)</th>
                <th>近一季股本</th>
                <th>近一季合約負債_流動</th>
                <th>當月營收</th>
                <th>近3月平均營收</th>
                <th>近12月平均營收</th>
                <th>營收年增率(A)</th>
                <th>營收月增率</th>
                <th>近一季營業毛利率</th>
                <th>近一季營業利益率</th>
                <th>近一季稅後淨利率</th>
                <th>近一季每股盈餘EPS</th>
                <th>營業毛利年增率(B)</th>
                <th>營業利益年增率(C)</th>
                <th>稅後淨利年增率(D)</th>
                <th>EPS年增率(E)</th>
                <th>近一日殖利率</th>
                <th>A+B+C+D+E
                    (滿分50)</th>
                <th>外資+投信
                    (滿分20)</th>
                <th>category</th>


            </tr>
        </thead>
        <tbody>
            <!-- 数据将被动态填充 -->
        </tbody>
    </table>
</div2>
<script type="text/javascript">
    $(document).ready(function() {
        Papa.parse('https://raw.githubusercontent.com/catt5881/CBc/main/allstock_評分.csv', {
            download: true,
            header: true,
            complete: function(results) {
                // 过滤数据
                var filteredData = results.data.filter(function(row) {return row.symbol  && row.symbol !== '0'; });

                // 使用过滤后的数据初始化DataTables
                $('#myTable2').DataTable({
                    data: filteredData ,
                    order: [[19, 'desc' ]] ,// 0 表示第一列（stock_id），'desc' 表示降序
                    columns: [
                        { data: 'symbol' ,
                          defaultContent: 'N/A', 
                          className: ' stock_id-column', 
                          render: function(data, type, row) {
                                var url = 'https://tw.stock.yahoo.com/quote/' + data + '/technical-analysis';
                                return '<a href="' + url + '" target="_blank">' + data + '</a>';
                            }
                        },
                        { data: 'name' , defaultContent: 'N/A' , className: ' name-column'},
                        { data: '近一日收盤價' , defaultContent: 'N/A' , render: function(data) { return Math.round(data); } },
                        { data: '近一季股本' , defaultContent: 'N/A' , render: function(data) { return Math.round(data); } },
                        { data: '近一季合約負債_流動' , defaultContent: 'N/A' , render: function(data) { return Math.round(data); } },
                        { data: '當月營收' , defaultContent: 'N/A' , render: function(data) { return Math.round(data); }} ,
                        { data: '近3月平均營收' , defaultContent: 'N/A' , render: function(data) { return Math.round(data); } },
                        { data: '近12月平均營收' , defaultContent: 'N/A' , render: function(data) { return Math.round(data); } },
                        { data: 'rev_year_growth_營收年增率' , defaultContent: 'N/A' , render: function(data) { return Math.round(data); } },
                        { data: 'rev_month_growth_營收月增率' , defaultContent: 'N/A' , render: function(data) { return Math.round(data); } },
                        { data: '近一季營業毛利率' , defaultContent: 'N/A' , render: function(data) { return Math.round(data); } },
                        { data: '近一季營業利益率' , defaultContent: 'N/A' , render: function(data) { return Math.round(data); } },
                        { data: '近一季稅後淨利率' , defaultContent: 'N/A' , render: function(data) { return Math.round(data); } },
                        { data: '近一季每股盈餘EPS' , defaultContent: 'N/A' , render: function(data) { return Math.round(data); } },
                        { data: '最近一季營業毛利年增率' , defaultContent: 'N/A' , render: function(data) { return Math.round(data); } },
                        { data: '近一季營業利益年增率' , defaultContent: 'N/A' , render: function(data) { return Math.round(data); } },
                        { data: '近一季稅後淨利年增率' , defaultContent: 'N/A' , render: function(data) { return Math.round(data); } },
                        { data: 'eps_growth_rate_EPS年增率' , defaultContent: 'N/A' , render: function(data) { return Math.round(data); } },
                        { data: '近一日殖利率' , defaultContent: 'N/A' , render: function(data) { return Math.round(data); } },
                        { data: 'A+B+C+D+E' , defaultContent: 'N/A' , className: ' sum-column', render: function(data) { return Math.round(data); } },
                        { data: '外資+投信' , defaultContent: 'N/A' , className: '外資投信-column', render: function(data) { return Math.round(data); } },
                        { data: 'category' , defaultContent: 'N/A' , className: 'category-column' }


                    ]
                });
            }
        });
    });
</script> 

...
    </div>
    <!-- Footer -->
    <footer>
        <div3 class="container my-5">

            <footer class="text-center text-white" style="background-color: #f1f1f1;">
            <!-- Grid container -->
            <div class="container pt-4">
            <!-- Section: Social media -->
            
            <section class="mb-4">
                
                <!-- Facebook -->
                <a
                class="btn btn-link btn-floating btn-lg text-dark m-1"
                href="#!"
                role="button"
                data-mdb-ripple-color="dark"
                ><i class="fab fa-facebook-f"></i
                ></a>
        
                <!-- Twitter -->
                <a
                class="btn btn-link btn-floating btn-lg text-dark m-1"
                href="#!"
                role="button"
                data-mdb-ripple-color="dark"
                ><i class="fab fa-twitter"></i
                ></a>
        
                <!-- Google -->
                <a
                class="btn btn-link btn-floating btn-lg text-dark m-1"
                href="#!"
                role="button"
                data-mdb-ripple-color="dark"
                ><i class="fab fa-google"></i
                ></a>
        
                <!-- Instagram -->
                <a
                class="btn btn-link btn-floating btn-lg text-dark m-1"
                href="#!"
                role="button"
                data-mdb-ripple-color="dark"
                ><i class="fab fa-instagram"></i
                ></a>
        
                <!-- Linkedin -->
                <a
                class="btn btn-link btn-floating btn-lg text-dark m-1"
                href="#!"
                role="button"
                data-mdb-ripple-color="dark"
                ><i class="fab fa-linkedin"></i
                ></a>
                <!-- Github -->
                <a
                class="btn btn-link btn-floating btn-lg text-dark m-1"
                href="#!"
                role="button"
                data-mdb-ripple-color="dark"
                ><i class="fab fa-github"></i
                ></a>
            </section> 
            <!-- Section: Social media -->
            
            </div>
            <!-- Grid container -->
        
            <!-- Copyright -->
            <div class="text-center text-dark p-3" style="background-color: rgba(0, 0, 0, 0.2);">
            © 2023 Copyright:
            <a class="text-dark" href="Catt/">Catt</a>
            <h2>資料每日晚上9點後才更新</h2>

            </div>
            <!-- Copyright -->
        </footer>
            
        </div3>
    </footer>
    <!-- Footer -->

    <!-- 下雪特效代碼① -->
    <script type="text/javascript">
        /*https://cloud.tencent.com/developer/article/1071212*/
        /* 控制下雪 */
        function snowFall(snow) {
            /* 可配置属性 */
            snow = snow || {};
            this.maxFlake = snow.maxFlake || 200;   /* 最多片数 */
            this.flakeSize = snow.flakeSize || 10;  /* 雪花形状 */
            this.fallSpeed = snow.fallSpeed || 1;   /* 坠落速度 */
        }
        /* 兼容写法 */
        requestAnimationFrame = window.requestAnimationFrame ||
            window.mozRequestAnimationFrame ||
            window.webkitRequestAnimationFrame ||
            window.msRequestAnimationFrame ||
            window.oRequestAnimationFrame ||
            function(callback) { setTimeout(callback, 1000 / 60); };
     
        cancelAnimationFrame = window.cancelAnimationFrame ||
            window.mozCancelAnimationFrame ||
            window.webkitCancelAnimationFrame ||
            window.msCancelAnimationFrame ||
            window.oCancelAnimationFrame;
        /* 开始下雪 */
        snowFall.prototype.start = function(){
            /* 创建画布 */
            snowCanvas.apply(this);
            /* 创建雪花形状 */
            createFlakes.apply(this);
            /* 画雪 */
            drawSnow.apply(this)
        }
        /* 创建画布 */
        function snowCanvas() {
            /* 添加Dom结点 */
            var snowcanvas = document.createElement("canvas");
            snowcanvas.id = "snowfall";
            snowcanvas.width = window.innerWidth;
            snowcanvas.height = document.body.clientHeight;
            snowcanvas.setAttribute("style", "position:absolute; top: 0; left: 0; z-index: 1; pointer-events: none;");
            document.getElementsByTagName("body")[0].appendChild(snowcanvas);
            this.canvas = snowcanvas;
            this.ctx = snowcanvas.getContext("2d");
            /* 窗口大小改变的处理 */
            window.onresize = function() {
                snowcanvas.width = window.innerWidth;
                /* snowcanvas.height = window.innerHeight */
            }
        }
        /* 雪运动对象 */
        function flakeMove(canvasWidth, canvasHeight, flakeSize, fallSpeed) {
            this.x = Math.floor(Math.random() * canvasWidth);   /* x坐标 */
            this.y = Math.floor(Math.random() * canvasHeight);  /* y坐标 */
            this.size = Math.random() * flakeSize + 2;          /* 形状 */
            this.maxSize = flakeSize;                           /* 最大形状 */
            this.speed = Math.random() * 1 + fallSpeed;         /* 坠落速度 */
            this.fallSpeed = fallSpeed;                         /* 坠落速度 */
            this.velY = this.speed;                             /* Y方向速度 */
            this.velX = 0;                                      /* X方向速度 */
            this.stepSize = Math.random() / 30;                 /* 步长 */
            this.step = 0                                       /* 步数 */
        }
        flakeMove.prototype.update = function() {
            var x = this.x,
                y = this.y;
            /* 左右摆动(余弦) */
            this.velX *= 0.98;
            if (this.velY <= this.speed) {
                this.velY = this.speed
            }
            this.velX += Math.cos(this.step += .05) * this.stepSize;
     
            this.y += this.velY;
            this.x += this.velX;
            /* 飞出边界的处理 */
            if (this.x >= canvas.width || this.x <= 0 || this.y >= canvas.height || this.y <= 0) {
                this.reset(canvas.width, canvas.height)
            }
        };
        /* 飞出边界-放置最顶端继续坠落 */
        flakeMove.prototype.reset = function(width, height) {
            this.x = Math.floor(Math.random() * width);
            this.y = 0;
            this.size = Math.random() * this.maxSize + 2;
            this.speed = Math.random() * 1 + this.fallSpeed;
            this.velY = this.speed;
            this.velX = 0;
        };
        // 渲染雪花-随机形状（此处可修改雪花颜色！！！）
        flakeMove.prototype.render = function(ctx) {
            var snowFlake = ctx.createRadialGradient(this.x, this.y, 0, this.x, this.y, this.size);
            snowFlake.addColorStop(0, "rgba(255, 255, 255, 0.9)");  /* 此处是雪花颜色，默认是白色 ,"#AFDAEF" */ 
            snowFlake.addColorStop(.5, "rgba(255, 255, 255, 0.5)"); /* 若要改为其他颜色，请自行查 */
            snowFlake.addColorStop(1, "rgba(255, 255, 255, 0)");    /* 找16进制的RGB 颜色代码。 */
            ctx.save();
            ctx.fillStyle = snowFlake;
            ctx.beginPath();
            ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
            ctx.fill();
            ctx.restore();
        };
        /* 创建雪花-定义形状 */
        function createFlakes() {
            var maxFlake = this.maxFlake,
                flakes = this.flakes = [],
                canvas = this.canvas;
            for (var i = 0; i < maxFlake; i++) {
                flakes.push(new flakeMove(canvas.width, canvas.height, this.flakeSize, this.fallSpeed))
            }
        }
        /* 画雪 */
        function drawSnow() {
            var maxFlake = this.maxFlake,
                flakes = this.flakes;
            ctx = this.ctx, canvas = this.canvas, that = this;
            /* 清空雪花 */
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            for (var e = 0; e < maxFlake; e++) {
                flakes[e].update();
                flakes[e].render(ctx);
            }
            /*  一帧一帧的画 */
            this.loop = requestAnimationFrame(function() {
                drawSnow.apply(that);
            });
        }
        /* 调用及控制方法 */
        var snow = new snowFall({maxFlake:500});
        snow.start();
    </script>

    <!-- 下雪特效代碼② -->
    <script type="text/javascript">
        (function($){
            $.fn.snow = function(options){
            var $flake = $('<div id="snowbox" />').css({'position': 'absolute','z-index':'9999', 'top': '-50px'}).html('&#10052;'),
            documentHeight 	= $(document).height(),
            documentWidth	= $(document).width(),
            defaults = {
                minSize		: 10,
                maxSize		: 20,
                newOn		: 1000,
                flakeColor	: "#AFDAEF" /* 此处可以定义雪花颜色，若要白色可以改为#FFFFFF */
            },
            options	= $.extend({}, defaults, options);
            var interval= setInterval( function(){
            var startPositionLeft = Math.random() * documentWidth - 100,
            startOpacity = 0.5 + Math.random(),
            sizeFlake = options.minSize + Math.random() * options.maxSize,
            endPositionTop = documentHeight - 200,
            endPositionLeft = startPositionLeft - 500 + Math.random() * 500,
            durationFall = documentHeight * 10 + Math.random() * 5000;
            $flake.clone().appendTo('body').css({
                left: startPositionLeft,
                opacity: startOpacity,
                'font-size': sizeFlake,
                color: options.flakeColor
            }).animate({
                top: endPositionTop,
                left: endPositionLeft,
                opacity: 0.2
            },durationFall,'linear',function(){
                $(this).remove()
            });
            }, options.newOn);
            };
        })(jQuery);
        $(function(){
            $.fn.snow({ 
                minSize: 5, /* 定义雪花最小尺寸 */
                maxSize: 50,/* 定义雪花最大尺寸 */
                newOn: 300  /* 定义密集程度，数字越小越密集 */
            });
        });
    </script>




    

</body>
</html>